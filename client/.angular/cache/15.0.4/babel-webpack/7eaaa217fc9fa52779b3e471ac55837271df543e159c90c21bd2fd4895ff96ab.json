{"ast":null,"code":"import { FormControl, FormGroup } from '@angular/forms';\nimport { DinamicTable } from 'src/app/utils/DinamicTable';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"src/app/services/comunicator/comunicator-componets.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"../service/compras.service\";\nimport * as i5 from \"../../administracion/usuarios/service/usuarios.service\";\nimport * as i6 from \"../../administracion/proveedores/service/proveedores.service\";\nimport * as i7 from \"@angular/common\";\nimport * as i8 from \"../../../pipes/table-filter.pipe\";\nconst _c0 = [\"pagination\"];\nconst _c1 = [\"next\"];\nconst _c2 = [\"dataTables_info\"];\nconst _c3 = [\"rows\"];\nconst _c4 = [\"popup\"];\nfunction ComprasRealizadasComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"strong\");\n    i0.ɵɵtext(2, \"Fecha: \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"date\");\n    i0.ɵɵelementStart(5, \"strong\");\n    i0.ɵɵtext(6, \"al\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(7);\n    i0.ɵɵpipe(8, \"date\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"\", i0.ɵɵpipeBind2(4, 2, ctx_r0.initialDate, \"dd/MM/yyyy\"), \" \");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(8, 5, ctx_r0.endDate, \"dd/MM/yyyy\"), \"\\n\");\n  }\n}\nfunction ComprasRealizadasComponent_tr_42_td_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const i_r8 = i0.ɵɵnextContext().index;\n    const ctx_r9 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r9.providers[i_r8].name_provider);\n  }\n}\nfunction ComprasRealizadasComponent_tr_42_td_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const i_r8 = i0.ɵɵnextContext().index;\n    const ctx_r10 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\"\", ctx_r10.users[i_r8].names, \" \", ctx_r10.users[i_r8].last_names, \"\");\n  }\n}\nfunction ComprasRealizadasComponent_tr_42_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵpipe(7, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"td\");\n    i0.ɵɵtext(9);\n    i0.ɵɵpipe(10, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(11, ComprasRealizadasComponent_tr_42_td_11_Template, 2, 1, \"td\", 0);\n    i0.ɵɵtemplate(12, ComprasRealizadasComponent_tr_42_td_12_Template, 2, 2, \"td\", 0);\n    i0.ɵɵelementStart(13, \"td\");\n    i0.ɵɵtext(14);\n    i0.ɵɵpipe(15, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"td\", 29);\n    i0.ɵɵlistener(\"click\", function ComprasRealizadasComponent_tr_42_Template_td_click_16_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r14);\n      const buy_r7 = restoredCtx.$implicit;\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.redirectToDetallesCompra(buy_r7));\n    });\n    i0.ɵɵelement(17, \"i\", 30);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const buy_r7 = ctx.$implicit;\n    const i_r8 = ctx.index;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i_r8 + 1);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(buy_r7.id_buy);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(7, 7, buy_r7.date, \"dd/MM/yyyy\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(10, 10, buy_r7.time, \"HH:mm:ss aaaa\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.providers[i_r8] !== undefined);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.users[i_r8] !== undefined);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(15, 13, buy_r7.total_buy, buy_r7.coin + \" \"));\n  }\n}\nfunction ComprasRealizadasComponent_button_65_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 31);\n    i0.ɵɵlistener(\"click\", function ComprasRealizadasComponent_button_65_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r15 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r15.cancel(ctx_r15.popUp));\n    });\n    i0.ɵɵtext(1, \" \\u00A0\\u00A0CANCELAR\");\n    i0.ɵɵelementEnd();\n  }\n}\nexport class ComprasRealizadasComponent extends DinamicTable {\n  constructor(fb, renderer, comunicatorSvc, routes, route, comprasSvc, usersSvc, providersSvc) {\n    super(renderer);\n    this.fb = fb;\n    this.renderer = renderer;\n    this.comunicatorSvc = comunicatorSvc;\n    this.routes = routes;\n    this.route = route;\n    this.comprasSvc = comprasSvc;\n    this.usersSvc = usersSvc;\n    this.providersSvc = providersSvc;\n    this.buys = [];\n    this.users = [];\n    this.providers = [];\n    this.title = [];\n    this.currentData = [];\n    this.date = new Date();\n    this.initialDate = new Date(this.date.getFullYear(), this.date.getMonth(), 1);\n    this.endDate = new Date(this.date.getFullYear(), this.date.getMonth() + 1, 0);\n  }\n  ngOnInit() {\n    let title = [];\n    let ruta;\n    setTimeout(() => {\n      /* Obtengo la ruta actual y la transformo para obtener el titulo del componente*/\n      ruta = this.routes.url.slice(this.routes.url.slice(1).indexOf('/') + 2, this.routes.url.lastIndexOf('?'));\n      title.push(decodeURI(ruta).toUpperCase()); //añado el titulo al array\n      title.push(\"fas fa-file-invoice-dollar fa-fw\"); //aañado el icono del titulo al array\n      this.comunicatorSvc.setTitleComponent(title);\n    });\n    this.route.queryParams.subscribe(params => {\n      if (Object.entries(params).length === 2) {\n        this.initialDate = new Date(params['initialDate']), this.endDate = new Date(params['endDate']);\n      } else if (Object.entries(params).length === 1) {\n        this.criterio = params['criterio'];\n        console.log(this.criterio);\n      }\n      if (Object.entries(params).length === 2 || Object.entries(params).length === 0) {\n        this.data$ = this.comprasSvc.getBuysBydate(this.initialDate, this.endDate).subscribe({\n          next: res => {\n            this.buscarAspectosDeCompra(res);\n          },\n          error: error => {\n            this.error(error);\n          },\n          complete: () => {\n            this.createPages(this.tableSearch, this.currentData, this.buys);\n            this.comunicatorSvc.getData().subscribe(res => this.currentData = res);\n          }\n        });\n      } else {\n        this.data$ = this.comprasSvc.getBuy(Number(this.criterio)).subscribe({\n          next: res => {\n            this.buscarAspectosDeCompra(res);\n          }\n        });\n      }\n    });\n    this.tableSearch = new FormGroup({\n      search: new FormControl(),\n      numberRows: new FormControl('10')\n    });\n  }\n  buscarAspectosDeCompra(res) {\n    if (res instanceof Array) {\n      res.forEach(buy => {\n        this.usersSvc.getUser(buy.id_user).subscribe(user => {\n          if (user instanceof Array) this.users.push(user[0]);\n        });\n        this.providersSvc.getProvider(buy.id_provider).subscribe(provider => {\n          if (provider instanceof Array) this.providers.push(provider[0]);\n        });\n      });\n      this.currentData = res;\n      this.buys = res;\n    } else {\n      this.changeModal(res);\n      this.popUp?.nativeElement.showModal();\n    }\n  }\n  error(error) {\n    this.changeModal(this.comunicatorSvc.errorServer(error));\n    this.popUp?.nativeElement.showModal();\n  }\n  redirectToDetallesCompra(buy) {\n    this.routes.navigate(['/compras/detalles compra'], {\n      queryParams: {\n        id_buy: buy.id_buy\n      }\n    });\n  }\n  ngOnDestroy() {\n    this.data$?.unsubscribe();\n  }\n}\nComprasRealizadasComponent.ɵfac = function ComprasRealizadasComponent_Factory(t) {\n  return new (t || ComprasRealizadasComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i0.Renderer2), i0.ɵɵdirectiveInject(i2.ComunicatorComponetsService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i3.ActivatedRoute), i0.ɵɵdirectiveInject(i4.ComprasService), i0.ɵɵdirectiveInject(i5.UsuariosService), i0.ɵɵdirectiveInject(i6.ProveedoresService));\n};\nComprasRealizadasComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ComprasRealizadasComponent,\n  selectors: [[\"app-compras-realizadas\"]],\n  viewQuery: function ComprasRealizadasComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5);\n      i0.ɵɵviewQuery(_c1, 5);\n      i0.ɵɵviewQuery(_c2, 5);\n      i0.ɵɵviewQuery(_c3, 5);\n      i0.ɵɵviewQuery(_c4, 7);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.pagination = _t.first);\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.next = _t.first);\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.info = _t.first);\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.row = _t.first);\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.popUp = _t.first);\n    }\n  },\n  features: [i0.ɵɵInheritDefinitionFeature],\n  decls: 66,\n  vars: 13,\n  consts: [[4, \"ngIf\"], [1, \"table-container\"], [1, \"table-title\"], [1, \"table-body\"], [1, \"search-pagination\", 3, \"formGroup\"], [1, \"dataTable-length\"], [\"name\", \"dataTable_length\", \"formControlName\", \"numberRows\", 1, \"custom-select\", 3, \"change\"], [\"value\", \"2\"], [\"value\", \"10\"], [\"value\", \"25\"], [\"value\", \"50\"], [\"value\", \"100\"], [1, \"table-responsive\"], [1, \"table\", \"table-bordered\"], [4, \"ngFor\", \"ngForOf\"], [1, \"search-pagination\"], [1, \"dataTables_info\"], [\"dataTables_info\", \"\"], [1, \"pagination-responsive\"], [1, \"pagination\"], [\"pagination\", \"\"], [1, \"previous\", \"page-item\", \"dataTables_info\", \"items\", 3, \"click\"], [1, \"next\", \"dataTables_info\", \"active\", \"items\", 3, \"click\"], [\"next\", \"\"], [1, \"dialog\"], [\"popup\", \"\"], [1, \"fa-regular\", \"fa-circle-question\"], [1, \"form-button\", \"btn-save\", 3, \"click\"], [\"class\", \"form-button btn-cancel\", 3, \"click\", 4, \"ngIf\"], [1, \"icon\", 3, \"click\"], [1, \"fas\", \"fa-shopping-bag\", \"fa-fw\", 2, \"color\", \"#03a9f4\"], [1, \"form-button\", \"btn-cancel\", 3, \"click\"]],\n  template: function ComprasRealizadasComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, ComprasRealizadasComponent_div_0_Template, 9, 8, \"div\", 0);\n      i0.ɵɵelementStart(1, \"div\", 1)(2, \"div\", 2)(3, \"h6\");\n      i0.ɵɵtext(4, \"Compras realizadas\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(5, \"div\", 3)(6, \"div\", 4)(7, \"div\", 5)(8, \"label\");\n      i0.ɵɵtext(9, \"Mostrar \");\n      i0.ɵɵelementStart(10, \"select\", 6);\n      i0.ɵɵlistener(\"change\", function ComprasRealizadasComponent_Template_select_change_10_listener() {\n        return ctx.createPages(ctx.tableSearch, ctx.currentData, ctx.buys);\n      });\n      i0.ɵɵelementStart(11, \"option\", 7);\n      i0.ɵɵtext(12, \"2\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(13, \"option\", 8);\n      i0.ɵɵtext(14, \"10\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(15, \"option\", 9);\n      i0.ɵɵtext(16, \"25\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(17, \"option\", 10);\n      i0.ɵɵtext(18, \"50\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(19, \"option\", 11);\n      i0.ɵɵtext(20, \"100\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵtext(21, \" entradas\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(22, \"div\", 12)(23, \"table\", 13)(24, \"thead\")(25, \"tr\")(26, \"th\");\n      i0.ɵɵtext(27, \"N\\u00B0\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(28, \"th\");\n      i0.ɵɵtext(29, \"N\\u00B0 factura\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(30, \"th\");\n      i0.ɵɵtext(31, \"Fecha\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(32, \"th\");\n      i0.ɵɵtext(33, \"Hora\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(34, \"th\");\n      i0.ɵɵtext(35, \"Proveedor\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(36, \"th\");\n      i0.ɵɵtext(37, \"Usuario\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(38, \"th\");\n      i0.ɵɵtext(39, \"Total\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(40, \"th\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(41, \"tbody\");\n      i0.ɵɵtemplate(42, ComprasRealizadasComponent_tr_42_Template, 18, 16, \"tr\", 14);\n      i0.ɵɵpipe(43, \"tableFilter\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(44, \"div\", 15);\n      i0.ɵɵelement(45, \"div\", 16, 17);\n      i0.ɵɵelementStart(47, \"div\", 18)(48, \"ul\", 19, 20)(50, \"li\", 21);\n      i0.ɵɵlistener(\"click\", function ComprasRealizadasComponent_Template_li_click_50_listener() {\n        return ctx.previousPage(ctx.tableSearch, ctx.currentData, ctx.buys);\n      });\n      i0.ɵɵtext(51, \" Previous \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(52, \"li\", 22, 23);\n      i0.ɵɵlistener(\"click\", function ComprasRealizadasComponent_Template_li_click_52_listener() {\n        return ctx.nextPage(ctx.tableSearch, ctx.currentData, ctx.buys);\n      });\n      i0.ɵɵtext(54, \" Next \");\n      i0.ɵɵelementEnd()()()()()();\n      i0.ɵɵelementStart(55, \"dialog\", 24, 25);\n      i0.ɵɵelement(57, \"i\", 26);\n      i0.ɵɵelementStart(58, \"h3\");\n      i0.ɵɵtext(59, \"\\u00BFEst\\u00E1s seguro?\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(60, \"p\");\n      i0.ɵɵtext(61, \"Los datos seran guardados en el sistema\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(62, \"div\")(63, \"button\", 27);\n      i0.ɵɵlistener(\"click\", function ComprasRealizadasComponent_Template_button_click_63_listener() {\n        return ctx.cancel(ctx.popUp);\n      });\n      i0.ɵɵtext(64, \" \\u00A0\\u00A0ACEPTAR\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(65, ComprasRealizadasComponent_button_65_Template, 2, 0, \"button\", 28);\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", ctx.criterio === undefined);\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"formGroup\", ctx.tableSearch);\n      i0.ɵɵadvance(36);\n      i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind2(43, 10, ctx.buys, ctx.getValuesToPipe(ctx.tableSearch)));\n      i0.ɵɵadvance(8);\n      i0.ɵɵclassProp(\"disable\", ctx.getValuesToPipe(ctx.tableSearch).indexCurrentPage === 0)(\"active\", ctx.getValuesToPipe(ctx.tableSearch).indexCurrentPage != 0);\n      i0.ɵɵadvance(2);\n      i0.ɵɵclassProp(\"disable\", ctx.getValuesToPipe(ctx.tableSearch).indexCurrentPage === ctx.numberPages - 1);\n      i0.ɵɵadvance(13);\n      i0.ɵɵproperty(\"ngIf\", (ctx.popUp == null ? null : ctx.popUp.nativeElement.children[1].textContent) === \"\\u00BFEst\\u00E1s seguro?\");\n    }\n  },\n  dependencies: [i7.NgForOf, i7.NgIf, i1.NgSelectOption, i1.ɵNgSelectMultipleOption, i1.SelectControlValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormControlName, i7.CurrencyPipe, i7.DatePipe, i8.TableFilterPipe],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":"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","names":["FormControl","FormGroup","DinamicTable","i0","ComprasRealizadasComponent","constructor","fb","renderer","comunicatorSvc","routes","route","comprasSvc","usersSvc","providersSvc","Date","date","getFullYear","getMonth","ngOnInit","title","ruta","setTimeout","url","slice","indexOf","lastIndexOf","push","decodeURI","toUpperCase","setTitleComponent","queryParams","subscribe","params","Object","entries","length","initialDate","endDate","criterio","console","log","data$","getBuysBydate","next","res","buscarAspectosDeCompra","error","complete","createPages","tableSearch","currentData","buys","getData","getBuy","Number","search","numberRows","Array","forEach","buy","getUser","id_user","user","users","getProvider","id_provider","provider","providers","changeModal","popUp","nativeElement","showModal","errorServer","redirectToDetallesCompra","navigate","id_buy","ngOnDestroy","unsubscribe","selectors","viewQuery","ctx"],"sourceRoot":"","sources":["/home/luis/Documentos/systems vs code/inventary-system/client/src/app/content/compras/compras-realizadas/compras-realizadas.component.ts","/home/luis/Documentos/systems vs code/inventary-system/client/src/app/content/compras/compras-realizadas/compras-realizadas.component.html"],"sourcesContent":["import { Component, ElementRef, Renderer2, ViewChild } from '@angular/core';\nimport { FormBuilder, FormControl, FormGroup } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { Observable, Subscription, tap } from 'rxjs';\nimport { alert, buy, fullBuy, provider, user } from 'src/app/interfaces/interfaces';\nimport { ComunicatorComponetsService } from 'src/app/services/comunicator/comunicator-componets.service';\nimport { DinamicTable } from 'src/app/utils/DinamicTable';\nimport { ComprasService } from '../service/compras.service';\nimport { HttpErrorResponse } from '@angular/common/http';\nimport { UsuariosService } from '../../administracion/usuarios/service/usuarios.service';\nimport { ProveedoresService } from '../../administracion/proveedores/service/proveedores.service';\n\n@Component({\n  selector: 'app-compras-realizadas',\n  templateUrl: './compras-realizadas.component.html',\n  styleUrls: ['./compras-realizadas.component.css']\n})\nexport class ComprasRealizadasComponent extends DinamicTable {\n\n\n  tableSearch!: FormGroup;\n  data$!: Subscription;\n  buys: buy[] = [];\n  users: user[] = []\n  providers: provider[] = []\n  title: string[] = [];\n  currentData: buy[] = [];\n  buyToDelete!: buy;\n  date = new Date()\n  initialDate: Date = new Date(this.date.getFullYear(), this.date.getMonth(), 1)\n  endDate: Date = new Date(this.date.getFullYear(), this.date.getMonth() + 1, 0)\n  criterio!:string;\n  //Elemento donde se insertaran los numeros \n  //de paginas para la paginacion\n  @ViewChild('pagination', { static: false }) override pagination?: ElementRef;\n  //Elemento antes del cual se comenzaran a insertar las paginas\n  @ViewChild('next', { static: false }) override next?: ElementRef;\n  //Elemento que muestra la informacion acerca de la cantidad de paginas mostradas, y filtradas\n  @ViewChild('dataTables_info', { static: false }) override info?: ElementRef;\n  //Elemento que tiene todas las filas de la tabla de la vista\n  @ViewChild('rows', { static: false }) row?: ElementRef;\n  //Elemento modal para mostrar alertas\n  @ViewChild('popup', { static: true }) override popUp?: ElementRef;\n\n\n  constructor(private fb: FormBuilder,\n    public override renderer: Renderer2,\n    private comunicatorSvc: ComunicatorComponetsService,\n    private routes: Router,\n    private route: ActivatedRoute,\n    private comprasSvc: ComprasService,\n    private usersSvc: UsuariosService,\n    private providersSvc: ProveedoresService) {\n    super(renderer)\n  }\n  ngOnInit() {\n\n    let title: string[] = [];\n    let ruta;\n    setTimeout(() => {\n      /* Obtengo la ruta actual y la transformo para obtener el titulo del componente*/\n      ruta = this.routes.url.slice((this.routes.url.slice(1).indexOf('/')) + 2, this.routes.url.lastIndexOf('?'));\n      title.push(decodeURI(ruta).toUpperCase());//añado el titulo al array\n      title.push(\"fas fa-file-invoice-dollar fa-fw\");//aañado el icono del titulo al array\n      this.comunicatorSvc.setTitleComponent(title);\n    })\n    this.route.queryParams.subscribe((params) => {\n      \n      if (Object.entries(params).length === 2) {\n        this.initialDate = new Date(params['initialDate']),\n          this.endDate = new Date(params['endDate'])\n      } else if (Object.entries(params).length === 1) {\n        this.criterio = params['criterio']\n        console.log(this.criterio)\n      }\n      if (Object.entries(params).length === 2 || Object.entries(params).length === 0) {\n        this.data$ = this.comprasSvc.getBuysBydate(this.initialDate, this.endDate).subscribe({\n          next: res => {\n            this.buscarAspectosDeCompra(res)\n          },\n          error: (error: HttpErrorResponse) => {\n            this.error(error)\n          },\n          complete: () => {\n            this.createPages(this.tableSearch, this.currentData, this.buys)\n            this.comunicatorSvc.getData().subscribe(res => this.currentData = res)\n          }\n        })\n      }else{\n        this.data$=this.comprasSvc.getBuy(Number(this.criterio)).subscribe({\n          next:res=>{this.buscarAspectosDeCompra(res)}\n        })\n      }\n    })\n    this.tableSearch = new FormGroup({\n      search: new FormControl(),\n      numberRows: new FormControl('10')\n    });\n  }\n\n  buscarAspectosDeCompra(res: buy[]|alert) {\n    if (res instanceof Array) {\n      res.forEach((buy: buy) => {\n        this.usersSvc.getUser(buy.id_user).subscribe(\n          user => {\n            if (user instanceof Array)\n              this.users.push(user[0])\n          })\n        this.providersSvc.getProvider(buy.id_provider).subscribe(\n          provider => {\n            if (provider instanceof Array)\n              this.providers.push(provider[0])\n          }\n        )\n      });\n      this.currentData = res;\n      this.buys = res\n    } else {\n      this.changeModal(res)\n      this.popUp?.nativeElement.showModal()\n    }\n  }\n\n  public error(error: HttpErrorResponse) {\n    this.changeModal(this.comunicatorSvc.errorServer(error))\n    this.popUp?.nativeElement.showModal()\n  }\n  redirectToDetallesCompra(buy: buy) {\n    this.routes.navigate(['/compras/detalles compra'], { queryParams: { id_buy: buy.id_buy } })\n  }\n\n  ngOnDestroy() {\n    this.data$?.unsubscribe();\n  }\n}\n","<div *ngIf=\"criterio===undefined\">\n    <strong>Fecha: </strong>{{initialDate|date:'dd/MM/yyyy'}}  <strong>al</strong>  {{endDate|date:'dd/MM/yyyy'}}\n</div>\n<div class=\"table-container\">\n    <div class=\"table-title\">\n        <h6>Compras realizadas</h6>\n    </div>\n    <div class=\"table-body\">\n        <div class=\"search-pagination\" [formGroup]=\"tableSearch\">\n            <div class=\"dataTable-length\">\n                <label>Mostrar\n                    <select name=\"dataTable_length\" \n                    formControlName=\"numberRows\" \n                    class=\"custom-select\"\n                        (change)=\"createPages(tableSearch,currentData,buys)\">\n                        <option value=\"2\">2</option>\n                        <option value=\"10\">10</option>\n                        <option value=\"25\">25</option>\n                        <option value=\"50\">50</option>\n                        <option value=\"100\">100</option>\n                    </select> entradas</label>\n            </div>\n            \n        </div>\n        <div class=\"table-responsive\">\n            <table class=\"table table-bordered\" >\n                <thead>\n                    <tr>\n                        <th>N°</th>\n                        <th>N° factura</th>\n                        <th>Fecha</th>\n                        <th>Hora</th>\n                        <th>Proveedor</th>\n                        <th>Usuario</th>\n                        <th>Total</th>\n                        <th></th>\n                    </tr>\n                </thead>\n                \n                <tbody>\n                    <tr *ngFor=\"let buy of buys | \n                    tableFilter:getValuesToPipe(tableSearch);let i=index\">\n                        <td>{{i+1}}</td>\n                        <td>{{buy.id_buy}}</td>\n                        <td>{{buy.date|date:'dd/MM/yyyy'}}</td>\n                        <td>{{buy.time|date:'HH:mm:ss aaaa'}}</td>\n                        <td *ngIf=\"providers[i]!==undefined\">{{providers[i].name_provider}}</td>\n                        <td *ngIf=\"users[i]!==undefined\">{{users[i].names}} {{users[i].last_names}}</td>\n                        <td>{{buy.total_buy|currency:buy.coin+' '}}</td>\n                        <td class=\"icon\" (click)=\"redirectToDetallesCompra(buy)\"><i class=\"fas fa-shopping-bag fa-fw\" style=\"color:#03a9f4\"></i></td>\n                    </tr>\n                </tbody>\n            </table>\n        </div>\n        <div class=\"search-pagination\">\n            <div class=\"dataTables_info\" #dataTables_info>\n            </div>\n            <div class=\"pagination-responsive\">\n                <ul class=\"pagination\" #pagination>\n                    <li class=\"previous page-item dataTables_info items\"\n                        [class.disable]=\"getValuesToPipe(tableSearch).indexCurrentPage===0\"\n                        [class.active]=\"getValuesToPipe(tableSearch).indexCurrentPage!=0\" \n                        (click)=\"previousPage(tableSearch,currentData,buys)\">\n                        Previous\n                    </li>\n\n                    <li class=\"next dataTables_info active items\" #next\n                        [class.disable]=\"getValuesToPipe(tableSearch).indexCurrentPage===numberPages-1\" \n                        (click)=\"nextPage(tableSearch,currentData,buys)\">\n                        Next\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </div>\n</div>\n<dialog class=\"dialog\" #popup>\n    <i class=\"fa-regular fa-circle-question\"></i>\n    <h3>¿Estás seguro?</h3>\n    <p>Los datos seran guardados en el sistema</p>\n    <div>\n        <button class=\"form-button btn-save\" (click)=\"cancel(popUp)\">\n            &nbsp;&nbsp;ACEPTAR</button>\n        <button *ngIf=\"this.popUp?.nativeElement.children[1].textContent === '¿Estás seguro?'\"\n            class=\"form-button btn-cancel\" (click)=\"cancel(popUp)\">\n            &nbsp;&nbsp;CANCELAR</button>\n    </div>\n</dialog>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}