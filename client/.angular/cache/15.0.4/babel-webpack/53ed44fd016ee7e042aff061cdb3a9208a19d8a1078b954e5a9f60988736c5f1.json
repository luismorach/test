{"ast":null,"code":"import { FormControl } from '@angular/forms';\nimport { DinamicInput } from 'src/app/utils/DinamicInput';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"src/app/services/comunicator/comunicator-componets.service\";\nimport * as i3 from \"../../ventas/service/ventas.service\";\nimport * as i4 from \"../../administracion/usuarios/service/usuarios.service\";\nimport * as i5 from \"../../productos/productos-en-almacen/service/productos.service\";\nimport * as i6 from \"@angular/forms\";\nimport * as i7 from \"@angular/common\";\nimport * as i8 from \"../../devoluciones/service/devoluciones.service\";\nconst _c0 = [\"quantity\"];\nconst _c1 = [\"popup\"];\nfunction DetallesVentaComponent_tr_38_td_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const i_r8 = i0.ɵɵnextContext().index;\n    const ctx_r9 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r9.products[i_r8].barcode);\n  }\n}\nfunction DetallesVentaComponent_tr_38_td_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const i_r8 = i0.ɵɵnextContext().index;\n    const ctx_r10 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate3(\" \", ctx_r10.products[i_r8].name, \"\\u00A0\", ctx_r10.products[i_r8].mark, \"\\u00A0\", ctx_r10.products[i_r8].model, \"\\u00A0\");\n  }\n}\nfunction DetallesVentaComponent_tr_38_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, DetallesVentaComponent_tr_38_td_3_Template, 2, 1, \"td\", 31);\n    i0.ɵɵtemplate(4, DetallesVentaComponent_tr_38_td_4_Template, 2, 3, \"td\", 31);\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵpipe(9, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"td\");\n    i0.ɵɵtext(11);\n    i0.ɵɵpipe(12, \"percent\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"td\");\n    i0.ɵɵtext(14);\n    i0.ɵɵpipe(15, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"td\");\n    i0.ɵɵtext(17);\n    i0.ɵɵpipe(18, \"percent\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"td\");\n    i0.ɵɵtext(20);\n    i0.ɵɵpipe(21, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(22, \"td\", 32);\n    i0.ɵɵlistener(\"click\", function DetallesVentaComponent_tr_38_Template_td_click_22_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r14);\n      const i_r8 = restoredCtx.index;\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.showModal(ctx_r13.products[i_r8], i_r8));\n    });\n    i0.ɵɵelement(23, \"i\", 33);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const sell_product_r7 = ctx.$implicit;\n    const i_r8 = ctx.index;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i_r8 + 1);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.products[i_r8] != undefined);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.products[i_r8] != undefined);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", sell_product_r7.quantity_products, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(9, 9, sell_product_r7.sell_price, ctx_r1.sell.coin + \" \"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(12, 12, sell_product_r7.discount_product, \"2.2-2\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(15, 15, sell_product_r7.discount_product * sell_product_r7.sell_price, ctx_r1.sell.coin + \" \"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(18, 18, sell_product_r7.impuest, \"2.2-2\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(21, 21, ctx_r1.calcularSubtotal(i_r8), ctx_r1.sell.coin + \" \"));\n  }\n}\nfunction DetallesVentaComponent_tr_94_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"td\");\n    i0.ɵɵtext(9);\n    i0.ɵɵpipe(10, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"td\");\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"td\");\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"td\");\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const pay_r15 = ctx.$implicit;\n    const i_r16 = ctx.index;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i_r16 + 1);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(5, 8, pay_r15.date, \"dd/MM/yyyy\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(pay_r15.type);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(10, 11, pay_r15.mount, pay_r15.coin + \" \"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(pay_r15.reference);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"\", ctx_r3.user_pay[i_r16].names_user, \" \", ctx_r3.user_pay[i_r16].last_names_user, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r3.registers_pay[i_r16].name);\n  }\n}\nfunction DetallesVentaComponent_button_149_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r18 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 34);\n    i0.ɵɵlistener(\"click\", function DetallesVentaComponent_button_149_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r18);\n      const ctx_r17 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r17.cancel(ctx_r17.popUp));\n    });\n    i0.ɵɵtext(1, \" \\u00A0\\u00A0CANCELAR\");\n    i0.ɵɵelementEnd();\n  }\n}\nconst _c2 = function (a0, a1) {\n  return {\n    \"input-on-focus-success\": a0,\n    \"input-on-focus-fail\": a1\n  };\n};\nconst _c3 = function (a0, a1) {\n  return {\n    \"label-on-focus-down\": a0,\n    \"label-on-focus-up\": a1\n  };\n};\nconst _c4 = function (a0) {\n  return {\n    \"enable aceptar\": a0\n  };\n};\nexport class DetallesVentaComponent extends DinamicInput {\n  constructor(routes, comunicatorSvc, renderer, route, ventasSvc, usuariosSvc, productosSvc, fb, location, devolucionesSvc) {\n    super();\n    this.routes = routes;\n    this.comunicatorSvc = comunicatorSvc;\n    this.renderer = renderer;\n    this.route = route;\n    this.ventasSvc = ventasSvc;\n    this.usuariosSvc = usuariosSvc;\n    this.productosSvc = productosSvc;\n    this.fb = fb;\n    this.location = location;\n    this.devolucionesSvc = devolucionesSvc;\n    this.title = [];\n    this.user_pay = [];\n    this.registers_pay = [];\n    this.sell_products = [];\n    this.repayments = [];\n    this.products = [];\n    this.pays = [];\n  }\n  ngOnInit() {\n    setTimeout(() => {\n      /* Obtengo la ruta actual y la transformo para obtener el titulo del componente*/\n      this.ruta = this.routes.url.slice(this.routes.url.slice(1).indexOf('/') + 2, this.routes.url.lastIndexOf('?'));\n      this.title.push(\"fas fa-coins fa-fw\"); //aañado el icono del titulo al array\n      this.title.push(decodeURI(this.ruta).toUpperCase()); //añado el titulo al array\n      this.comunicatorSvc.setTitleComponent(this.title);\n    });\n    this.route.queryParams.subscribe(params => {\n      this.ventasSvc.getSell(params['id_sell']).subscribe(res => {\n        let aux = res;\n        this.sell = aux[0];\n      });\n      this.ventasSvc.getProductsSell(params['id_sell']).subscribe(res => {\n        if (res instanceof Array) {\n          let aux = res;\n          this.products = aux;\n          this.sell_products = aux;\n        }\n      });\n      this.ventasSvc.getPaysSell(params['id_sell']).subscribe(res => {\n        console.log(res);\n        if (res instanceof Array) {\n          let aux = res;\n          this.user_pay = aux;\n          this.registers_pay = aux;\n          this.pays = aux;\n        }\n      });\n    });\n    this.formDevolucion = this.fb.group({\n      quantity_back: new FormControl('')\n    });\n  }\n  showModal(product, index) {\n    this.indexElementToBack = index;\n    this.renderer.setProperty(this.quantityBack?.nativeElement.children[0].children[0], 'textContent', 'Realizar Devolución (' + product.name + ' ' + product.mark + ' ' + product.model + ')');\n    this.quantityBack?.nativeElement.showModal();\n  }\n  calcularPromedio(price) {\n    return (this.products[this.indexElementToBack].sell_price * this.products[this.indexElementToBack].exist_quantity - this.sell_products[this.indexElementToBack].sell_price * Number(this.formDevolucion.get('quantity_back')?.value)) / (this.products[this.indexElementToBack].exist_quantity - Number(this.formDevolucion.get('quantity_back')?.value));\n  }\n  registrarDevolucion() {\n    let content = '';\n    if (Number(this.formDevolucion.get('quantity_back')?.value) > this.sell_products[this.indexElementToBack].quantity_products - this.sell_products[this.indexElementToBack].quantity_back) {\n      content = 'La cantidad a devolver es mayor a la registrada en la compra';\n    } else if (this.products[this.indexElementToBack].exist_quantity - Number(this.formDevolucion.get('quantity_back')?.value) < 0) {\n      content = 'No existe esa cantidad en el almacen, los productos ya han sido vendidos';\n    } else {\n      let repayment = {\n        type: 'compra',\n        date: new Date(),\n        id_operation: this.sell_products[this.indexElementToBack].id_sell,\n        quantity: Number(this.formDevolucion.get('quantity_back')?.value),\n        price: this.sell_products[this.indexElementToBack].sell_price,\n        total: Number(this.formDevolucion.get('quantity_back')?.value) * this.sell_products[this.indexElementToBack].sell_price,\n        coin: this.sell.coin,\n        exist_quantity: this.products[this.indexElementToBack].exist_quantity - Number(this.formDevolucion.get('quantity_back')?.value),\n        weighted_averages: Number(((this.products[this.indexElementToBack].sell_price * this.products[this.indexElementToBack].exist_quantity - this.comunicatorSvc.converterToMainCoin(this.sell_products[this.indexElementToBack].sell_price, this.sell.exchange) * Number(this.formDevolucion.get('quantity_back')?.value)) / (this.products[this.indexElementToBack].exist_quantity - Number(this.formDevolucion.get('quantity_back')?.value))).toFixed(2)),\n        id_user: this.sell.id_user,\n        id_product: this.sell_products[this.indexElementToBack].id_product\n      };\n      repayment.weighted_averages = isNaN(repayment.weighted_averages) ? 0 : repayment.weighted_averages;\n      repayment.weighted_averages = this.comunicatorSvc.converterToSecondaryCoin(repayment.weighted_averages, this.sell.exchange);\n      this.devolucionesSvc.setRepayment(repayment).subscribe(res => {\n        if (res.title.includes('Registrada')) {\n          this.repayments.push(repayment);\n          this.sell_products[this.indexElementToBack].quantity_back += Number(this.formDevolucion.get('quantity_back')?.value);\n          this.sell.total_sell -= Number(this.formDevolucion.get('quantity_back')?.value) * this.sell_products[this.indexElementToBack].sell_price;\n          this.products[this.indexElementToBack].sell_price = this.comunicatorSvc.converterToMainCoin(repayment.weighted_averages, this.sell.exchange);\n          this.products[this.indexElementToBack].sell_price = Number(((this.products[this.indexElementToBack].sell_price * this.products[this.indexElementToBack].exist_quantity - this.comunicatorSvc.converterToMainCoin(this.sell_products[this.indexElementToBack].sell_price, this.sell.exchange) * Number(this.formDevolucion.get('quantity_back')?.value)) / (this.products[this.indexElementToBack].exist_quantity - Number(this.formDevolucion.get('quantity_back')?.value))).toFixed(2));\n          this.products[this.indexElementToBack].exist_quantity = repayment.exist_quantity;\n          console.log(this.products[this.indexElementToBack].sell_price);\n          this.products[this.indexElementToBack].sell_price = this.products[this.indexElementToBack].exist_quantity === 0 ? 0 : this.products[this.indexElementToBack].sell_price;\n          this.ventasSvc.updateSell(this.sell_products[this.indexElementToBack].id_sell, this.sell).subscribe(res => console.log(res));\n          this.ventasSvc.updateProductsSell(this.sell_products[this.indexElementToBack].id_sell, this.sell_products[this.indexElementToBack].id_product, this.sell_products[this.indexElementToBack]).subscribe(res => console.log(res));\n          this.productosSvc.updateProducto(this.products[this.indexElementToBack].id_product, this.products[this.indexElementToBack]).subscribe(res => console.log(res));\n        }\n        console.log(res);\n        this.changeModal(res);\n        this.popUp?.nativeElement.showModal();\n      });\n    }\n    if (content !== '') {\n      let values = {\n        icon: 'fa-regular fa-circle-xmark',\n        title: 'Ocurrió un error inesperado',\n        content: content\n      };\n      this.changeModal(values);\n      this.popUp?.nativeElement.showModal();\n    }\n  }\n  calcularSubtotal(index) {\n    let price = this.products[index].sell_price;\n    let discount = this.products[index].discount;\n    let quantity = this.sell_products[index].quantity_products;\n    return Number((price * quantity - Number((price * discount).toFixed(2)) * quantity).toFixed(2));\n  }\n  calcularTotal() {\n    let total = 0;\n    this.products.forEach((product, index) => {\n      total += this.calcularSubtotal(index);\n    });\n    return total;\n  }\n  calcularDescuentoVenta() {\n    return Number((this.sell.discount * this.calcularTotal()).toFixed(2));\n  }\n  calcularImpuestoVenta() {\n    let montoImponible = 0;\n    this.products.forEach((product, index) => {\n      if (product.impuest > 0) {\n        montoImponible += Number((product.impuest * this.calcularSubtotal(index)).toFixed(2));\n      }\n    });\n    return montoImponible;\n  }\n  total() {\n    return Number((this.calcularTotal() + this.calcularImpuestoVenta() - this.calcularDescuentoVenta()).toFixed(2));\n  }\n  redirectToVentasRealizadas() {\n    this.location.back();\n  }\n  product(repayment) {\n    let name_product = '';\n    this.products.forEach(product => {\n      if (product.id_product === repayment.id_product) {\n        name_product = product.name + ' ' + product.mark + ' ' + product.model;\n      }\n    });\n    return name_product;\n  }\n  acept() {\n    if (this.popUp?.nativeElement.children[1].textContent === 'Ocurrió un error inesperado') {\n      this.cancel(this.popUp);\n    } else {\n      this.cancel(this.popUp);\n      this.cancel(this.quantityBack);\n    }\n  }\n}\nDetallesVentaComponent.ɵfac = function DetallesVentaComponent_Factory(t) {\n  return new (t || DetallesVentaComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.ComunicatorComponetsService), i0.ɵɵdirectiveInject(i0.Renderer2), i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i3.VentasService), i0.ɵɵdirectiveInject(i4.UsuariosService), i0.ɵɵdirectiveInject(i5.ProductosService), i0.ɵɵdirectiveInject(i6.FormBuilder), i0.ɵɵdirectiveInject(i7.Location), i0.ɵɵdirectiveInject(i8.DevolucionesService));\n};\nDetallesVentaComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: DetallesVentaComponent,\n  selectors: [[\"app-detalles-venta\"]],\n  viewQuery: function DetallesVentaComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 7);\n      i0.ɵɵviewQuery(_c1, 7);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.quantityBack = _t.first);\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.popUp = _t.first);\n    }\n  },\n  features: [i0.ɵɵInheritDefinitionFeature],\n  decls: 150,\n  vars: 34,\n  consts: [[1, \"form-container\"], [1, \"datos\"], [1, \"form-button\", \"btn-save\", 3, \"click\"], [1, \"fas\", \"fa-reply\"], [1, \"table-container\"], [1, \"table-title\"], [1, \"table-body\"], [1, \"table-responsive\"], [1, \"table\", \"table-bordered\"], [\"tab\", \"\"], [4, \"ngFor\", \"ngForOf\"], [1, \"totales\"], [1, \"line\"], [1, \"quantity\"], [\"quantity\", \"\"], [1, \"header\"], [1, \"title\"], [1, \"btn-cerrar-dialog\", 3, \"click\"], [1, \"form\", 3, \"formGroup\"], [1, \"form-control\", 3, \"ngClass\"], [1, \"form-label\", 3, \"ngClass\", \"ngStyle\"], [\"formControlName\", \"quantity_back\", 1, \"form-input\", 3, \"ngStyle\", \"focus\", \"focusout\", \"keypress\"], [1, \"form-actions\"], [1, \"form-button\", \"btn\", 3, \"ngClass\", \"click\"], [1, \"fas\", \"fa-truck-loading\", \"fa-fw\"], [1, \"form-button\", \"btn\", \"enable\", 2, \"color\", \"#f44336\", 3, \"click\"], [1, \"far\", \"fa-times-circle\"], [1, \"dialog\"], [\"popup\", \"\"], [1, \"fa-regular\", \"fa-circle-question\"], [\"class\", \"form-button btn-cancel\", 3, \"click\", 4, \"ngIf\"], [4, \"ngIf\"], [1, \"icon\", 3, \"click\"], [1, \"fas\", \"fa-truck-loading\", \"fa-fw\", 2, \"color\", \"#009688\"], [1, \"form-button\", \"btn-cancel\", 3, \"click\"]],\n  template: function DetallesVentaComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"p\");\n      i0.ɵɵtext(3);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(4, \"button\", 2);\n      i0.ɵɵlistener(\"click\", function DetallesVentaComponent_Template_button_click_4_listener() {\n        return ctx.redirectToVentasRealizadas();\n      });\n      i0.ɵɵelement(5, \"i\", 3);\n      i0.ɵɵtext(6, \" \\u00A0Regresar\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(7, \"div\", 4)(8, \"div\", 5)(9, \"h6\");\n      i0.ɵɵtext(10, \"productos vendidos\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(11, \"div\", 6)(12, \"div\", 7)(13, \"table\", 8)(14, \"thead\")(15, \"tr\")(16, \"th\");\n      i0.ɵɵtext(17, \"N\\u00B0\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(18, \"th\");\n      i0.ɵɵtext(19, \"C\\u00F3digo de barra\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(20, \"th\");\n      i0.ɵɵtext(21, \"Producto\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(22, \"th\");\n      i0.ɵɵtext(23, \"Cantidad\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(24, \"th\");\n      i0.ɵɵtext(25, \"Precio de venta\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(26, \"th\");\n      i0.ɵɵtext(27, \"Descuento\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(28, \"th\");\n      i0.ɵɵtext(29, \"Valor de descuento\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(30, \"th\");\n      i0.ɵɵtext(31, \"IVA\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(32, \"th\");\n      i0.ɵɵtext(33, \"Sub total\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(34, \"th\");\n      i0.ɵɵtext(35, \"Devoluci\\u00F3n\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(36, \"tbody\", null, 9);\n      i0.ɵɵtemplate(38, DetallesVentaComponent_tr_38_Template, 24, 24, \"tr\", 10);\n      i0.ɵɵelementEnd()()()()();\n      i0.ɵɵelementStart(39, \"div\", 11)(40, \"div\")(41, \"p\")(42, \"strong\");\n      i0.ɵɵtext(43, \"SUBTOTAL \");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(44, \"p\");\n      i0.ɵɵtext(45);\n      i0.ɵɵpipe(46, \"currency\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(47, \"div\")(48, \"p\")(49, \"strong\");\n      i0.ɵɵtext(50, \"IVA \");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(51, \"p\");\n      i0.ɵɵtext(52);\n      i0.ɵɵpipe(53, \"currency\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(54, \"div\")(55, \"p\")(56, \"strong\");\n      i0.ɵɵtext(57, \"DESCUENTO \");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(58, \"p\");\n      i0.ɵɵtext(59);\n      i0.ɵɵpipe(60, \"currency\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(61, \"div\")(62, \"p\")(63, \"strong\");\n      i0.ɵɵtext(64, \"TOTAL \");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(65, \"p\");\n      i0.ɵɵtext(66);\n      i0.ɵɵpipe(67, \"currency\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelement(68, \"div\", 12);\n      i0.ɵɵelementStart(69, \"div\", 4)(70, \"div\", 5)(71, \"h6\");\n      i0.ɵɵtext(72, \"Pagos realizados\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(73, \"div\", 6)(74, \"div\", 7)(75, \"table\", 8)(76, \"thead\")(77, \"tr\")(78, \"th\");\n      i0.ɵɵtext(79, \"N\\u00B0\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(80, \"th\");\n      i0.ɵɵtext(81, \"Fecha\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(82, \"th\");\n      i0.ɵɵtext(83, \"Tipo de venta\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(84, \"th\");\n      i0.ɵɵtext(85, \"Monto\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(86, \"th\");\n      i0.ɵɵtext(87, \"Referencia\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(88, \"th\");\n      i0.ɵɵtext(89, \"Vendedor\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(90, \"th\");\n      i0.ɵɵtext(91, \"caja\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(92, \"tbody\", null, 9);\n      i0.ɵɵtemplate(94, DetallesVentaComponent_tr_94_Template, 17, 14, \"tr\", 10);\n      i0.ɵɵelementEnd()()()()();\n      i0.ɵɵelementStart(95, \"div\", 4)(96, \"div\", 5)(97, \"h6\");\n      i0.ɵɵtext(98, \"Devoluciones realizadas\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(99, \"div\", 6)(100, \"div\", 7)(101, \"table\", 8)(102, \"thead\")(103, \"tr\")(104, \"th\");\n      i0.ɵɵtext(105, \"N\\u00B0\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(106, \"th\");\n      i0.ɵɵtext(107, \"Fecha\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(108, \"th\");\n      i0.ɵɵtext(109, \"Producto\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(110, \"th\");\n      i0.ɵɵtext(111, \"Cantidad\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(112, \"th\");\n      i0.ɵɵtext(113, \"Precio de compra\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(114, \"th\");\n      i0.ɵɵtext(115, \"Total\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(116, \"th\");\n      i0.ɵɵtext(117, \"Vendedor\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(118, \"th\");\n      i0.ɵɵtext(119, \"caja\");\n      i0.ɵɵelementEnd()()()()()()()();\n      i0.ɵɵelementStart(120, \"dialog\", 13, 14)(122, \"div\", 15)(123, \"h2\", 16);\n      i0.ɵɵtext(124, \"Realizar devoluci\\u00F3n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(125, \"button\", 17);\n      i0.ɵɵlistener(\"click\", function DetallesVentaComponent_Template_button_click_125_listener() {\n        return ctx.cancel(ctx.quantityBack);\n      });\n      i0.ɵɵtext(126, \"x\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(127, \"div\", 18)(128, \"div\", 19)(129, \"label\", 20);\n      i0.ɵɵtext(130, \" Cantidad a devolver \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(131, \"input\", 21);\n      i0.ɵɵlistener(\"focus\", function DetallesVentaComponent_Template_input_focus_131_listener() {\n        return ctx.isFocused(7, ctx.formDevolucion, \"quantity_back\");\n      })(\"focusout\", function DetallesVentaComponent_Template_input_focusout_131_listener() {\n        return ctx.isFocused(7, ctx.formDevolucion, \"quantity_back\");\n      })(\"keypress\", function DetallesVentaComponent_Template_input_keypress_131_listener($event) {\n        return ctx.validate($event, false);\n      });\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(132, \"div\", 22)(133, \"button\", 23);\n      i0.ɵɵlistener(\"click\", function DetallesVentaComponent_Template_button_click_133_listener() {\n        return ctx.registrarDevolucion();\n      });\n      i0.ɵɵelement(134, \"i\", 24);\n      i0.ɵɵtext(135, \" \\u00A0\\u00A0REALIZAR DEVOLUCI\\u00D3N\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(136, \"button\", 25);\n      i0.ɵɵlistener(\"click\", function DetallesVentaComponent_Template_button_click_136_listener() {\n        return ctx.cancel(ctx.quantityBack);\n      });\n      i0.ɵɵelement(137, \"i\", 26);\n      i0.ɵɵtext(138, \" \\u00A0\\u00A0CANCELAR\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(139, \"dialog\", 27, 28);\n      i0.ɵɵelement(141, \"i\", 29);\n      i0.ɵɵelementStart(142, \"h3\");\n      i0.ɵɵtext(143, \"\\u00BFEstas seguro?\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(144, \"p\");\n      i0.ɵɵtext(145, \"Lois datos seran guardados en el sistema\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(146, \"div\")(147, \"button\", 2);\n      i0.ɵɵlistener(\"click\", function DetallesVentaComponent_Template_button_click_147_listener() {\n        return ctx.acept();\n      });\n      i0.ɵɵtext(148, \" \\u00A0\\u00A0ACEPTAR\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(149, DetallesVentaComponent_button_149_Template, 2, 0, \"button\", 30);\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      let tmp_12_0;\n      i0.ɵɵadvance(3);\n      i0.ɵɵtextInterpolate1(\"id sell \", ctx.sell.id_sell, \"\");\n      i0.ɵɵadvance(35);\n      i0.ɵɵproperty(\"ngForOf\", ctx.sell_products);\n      i0.ɵɵadvance(7);\n      i0.ɵɵtextInterpolate1(\"+ \", i0.ɵɵpipeBind2(46, 14, ctx.calcularTotal(), ctx.sell.coin + \" \"), \"\");\n      i0.ɵɵadvance(7);\n      i0.ɵɵtextInterpolate1(\"+ \", i0.ɵɵpipeBind2(53, 17, ctx.calcularImpuestoVenta(), ctx.sell.coin + \" \"), \"\");\n      i0.ɵɵadvance(7);\n      i0.ɵɵtextInterpolate1(\"- \", i0.ɵɵpipeBind2(60, 20, ctx.calcularDescuentoVenta(), ctx.sell.coin + \" \"), \"\");\n      i0.ɵɵadvance(7);\n      i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(67, 23, ctx.total(), ctx.sell.coin + \" \"));\n      i0.ɵɵadvance(28);\n      i0.ɵɵproperty(\"ngForOf\", ctx.pays);\n      i0.ɵɵadvance(33);\n      i0.ɵɵproperty(\"formGroup\", ctx.formDevolucion);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(26, _c2, ctx.verifyStyleInput(ctx.formDevolucion, \"quantity_back\") && ctx.elementHasFocus[7], !ctx.verifyStyleInput(ctx.formDevolucion, \"quantity_back\")));\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(29, _c3, ctx.elementHasFocus[7] && ctx.positionLabel[7], ctx.elementHasFocus[7] && !ctx.positionLabel[7]))(\"ngStyle\", ctx.animationLabel(ctx.formDevolucion, \"quantity_back\"));\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngStyle\", ctx.styleForeground(ctx.formDevolucion, \"quantity_back\"));\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(32, _c4, ((tmp_12_0 = ctx.formDevolucion.get(\"quantity_back\")) == null ? null : tmp_12_0.value.length) > 0));\n      i0.ɵɵadvance(16);\n      i0.ɵɵproperty(\"ngIf\", (ctx.popUp == null ? null : ctx.popUp.nativeElement.children[1].textContent) === \"\\u00BFEst\\u00E1s seguro?\");\n    }\n  },\n  dependencies: [i7.NgClass, i7.NgForOf, i7.NgIf, i7.NgStyle, i6.DefaultValueAccessor, i6.NgControlStatus, i6.NgControlStatusGroup, i6.FormGroupDirective, i6.FormControlName, i7.PercentPipe, i7.CurrencyPipe, i7.DatePipe],\n  styles: [\".totales[_ngcontent-%COMP%]{\\n    display: flex;\\n    flex-direction: column;\\n    align-items: flex-end;\\n    margin-top: 0px;\\n}\\n.table-container[_ngcontent-%COMP%]{\\n    margin-bottom: 0px;\\n}\\n.totales[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{\\n    width: 20%;\\n    margin-right:5rem;\\n    display: flex;\\n    justify-content: space-between;\\n}\\n.totales[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{\\n    margin: .5rem;\\n}\\n.line[_ngcontent-%COMP%]{\\n    border-bottom: 1px dashed #D8D8D8;\\n    margin:5rem 0rem\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29udGVudC92ZW50YXMvZGV0YWxsZXMtdmVudGEvZGV0YWxsZXMtdmVudGEuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtJQUNJLGFBQWE7SUFDYixzQkFBc0I7SUFDdEIscUJBQXFCO0lBQ3JCLGVBQWU7QUFDbkI7QUFDQTtJQUNJLGtCQUFrQjtBQUN0QjtBQUNBO0lBQ0ksVUFBVTtJQUNWLGlCQUFpQjtJQUNqQixhQUFhO0lBQ2IsOEJBQThCO0FBQ2xDO0FBQ0E7SUFDSSxhQUFhO0FBQ2pCO0FBQ0E7SUFDSSxpQ0FBaUM7SUFDakM7QUFDSiIsInNvdXJjZXNDb250ZW50IjpbIi50b3RhbGVze1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICBhbGlnbi1pdGVtczogZmxleC1lbmQ7XG4gICAgbWFyZ2luLXRvcDogMHB4O1xufVxuLnRhYmxlLWNvbnRhaW5lcntcbiAgICBtYXJnaW4tYm90dG9tOiAwcHg7XG59XG4udG90YWxlcyBkaXZ7XG4gICAgd2lkdGg6IDIwJTtcbiAgICBtYXJnaW4tcmlnaHQ6NXJlbTtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2Vlbjtcbn1cbi50b3RhbGVzIGRpdiBwe1xuICAgIG1hcmdpbjogLjVyZW07XG59XG4ubGluZXtcbiAgICBib3JkZXItYm90dG9tOiAxcHggZGFzaGVkICNEOEQ4RDg7XG4gICAgbWFyZ2luOjVyZW0gMHJlbVxufSJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n});","map":{"version":3,"mappings":"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","names":["FormControl","DinamicInput","i0","DetallesVentaComponent","constructor","routes","comunicatorSvc","renderer","route","ventasSvc","usuariosSvc","productosSvc","fb","location","devolucionesSvc","ngOnInit","setTimeout","ruta","url","slice","indexOf","lastIndexOf","title","push","decodeURI","toUpperCase","setTitleComponent","queryParams","subscribe","params","getSell","res","aux","sell","getProductsSell","Array","products","sell_products","getPaysSell","console","log","user_pay","registers_pay","pays","formDevolucion","group","quantity_back","showModal","product","index","indexElementToBack","setProperty","quantityBack","nativeElement","children","name","mark","model","calcularPromedio","price","sell_price","exist_quantity","Number","get","value","registrarDevolucion","content","quantity_products","repayment","type","date","Date","id_operation","id_sell","quantity","total","coin","weighted_averages","converterToMainCoin","exchange","toFixed","id_user","id_product","isNaN","converterToSecondaryCoin","setRepayment","includes","repayments","total_sell","updateSell","updateProductsSell","updateProducto","changeModal","popUp","values","icon","calcularSubtotal","discount","calcularTotal","forEach","calcularDescuentoVenta","calcularImpuestoVenta","montoImponible","impuest","redirectToVentasRealizadas","back","name_product","acept","textContent","cancel","selectors","viewQuery","ctx"],"sourceRoot":"","sources":["/home/luis/Documentos/systems vs code/inventary-system/client/src/app/content/ventas/detalles-venta/detalles-venta.component.ts","/home/luis/Documentos/systems vs code/inventary-system/client/src/app/content/ventas/detalles-venta/detalles-venta.component.html"],"sourcesContent":["import { Component, ElementRef, Renderer2, ViewChild } from '@angular/core';\nimport { FormBuilder, FormControl, FormGroup } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { product, repayment, sell, sell_product, user, alert, pay, register } from 'src/app/interfaces/interfaces';\nimport { ComunicatorComponetsService } from 'src/app/services/comunicator/comunicator-componets.service';\nimport { DinamicInput } from 'src/app/utils/DinamicInput';\nimport { VentasService } from '../../ventas/service/ventas.service';\nimport { UsuariosService } from '../../administracion/usuarios/service/usuarios.service';\nimport { ProductosService } from '../../productos/productos-en-almacen/service/productos.service';\nimport { DevolucionesService } from '../../devoluciones/service/devoluciones.service';\nimport { Location } from '@angular/common';\n\n@Component({\n  selector: 'app-detalles-venta',\n  templateUrl: './detalles-venta.component.html',\n  styleUrls: ['./detalles-venta.component.css']\n})\nexport class DetallesVentaComponent extends DinamicInput {\n\n  ruta!: string\n  title: string[] = []\n  sell!: sell\n  user_sell!: user\n  user_pay: user[]=[]\n  registers_pay:register[]=[]\n  sell_products: sell_product[] = []\n  repayments: repayment[] = []\n  products: product[] = []\n  pays:pay[]=[]\n  indexElementToBack!: number\n  formDevolucion!: FormGroup\n  @ViewChild('quantity', { static: true }) quantityBack?: ElementRef;\n  @ViewChild('popup', { static: true }) override popUp?: ElementRef;\n\n  constructor(private routes: Router,\n    private comunicatorSvc: ComunicatorComponetsService,\n    public override renderer: Renderer2,\n    private route: ActivatedRoute,\n    private ventasSvc: VentasService,\n    private usuariosSvc: UsuariosService,\n    private productosSvc: ProductosService,\n    private fb: FormBuilder,\n    private location: Location,\n    private devolucionesSvc: DevolucionesService) {\n    super()\n  }\n\n  ngOnInit() {\n    setTimeout(() => {\n      /* Obtengo la ruta actual y la transformo para obtener el titulo del componente*/\n      this.ruta = this.routes.url.slice((this.routes.url.slice(1).indexOf('/')) + 2, this.routes.url.lastIndexOf('?'));\n      this.title.push(\"fas fa-coins fa-fw\");//aañado el icono del titulo al array\n      this.title.push(decodeURI(this.ruta).toUpperCase());//añado el titulo al array\n      this.comunicatorSvc.setTitleComponent(this.title);\n    });\n    this.route.queryParams.subscribe((params) => {\n      this.ventasSvc.getSell(params['id_sell']).subscribe(res => {\n        let aux: any = res\n        this.sell = aux[0]\n      })\n      this.ventasSvc.getProductsSell(params['id_sell']).subscribe(res => {\n        if (res instanceof Array){\n          let aux:any=res\n          this.products=aux\n          this.sell_products = aux\n        }\n      })\n      this.ventasSvc.getPaysSell(params['id_sell']).subscribe(res=>{\n        console.log(res)\n        if(res instanceof Array){\n          let aux:any=res\n          this.user_pay=aux\n          this.registers_pay=aux\n          this.pays=aux\n        }\n      })\n    })\n    this.formDevolucion = this.fb.group({\n      quantity_back: new FormControl('')\n    })\n  }\n  showModal(product: product, index: number) {\n    this.indexElementToBack = index\n    this.renderer.setProperty(this.quantityBack?.nativeElement.children[0].children[0],\n      'textContent', 'Realizar Devolución (' + product.name + ' ' + product.mark + ' ' + product.model + ')')\n    this.quantityBack?.nativeElement.showModal()\n  }\n  calcularPromedio(price: number) {\n    return ((this.products[this.indexElementToBack].sell_price *\n      this.products[this.indexElementToBack].exist_quantity) -\n      (this.sell_products[this.indexElementToBack].sell_price *\n        Number(this.formDevolucion.get('quantity_back')?.value))) /\n      (this.products[this.indexElementToBack].exist_quantity -\n        Number(this.formDevolucion.get('quantity_back')?.value))\n  }\n  registrarDevolucion() {\n    let content = ''\n    if (Number(this.formDevolucion.get('quantity_back')?.value) >\n      (this.sell_products[this.indexElementToBack].quantity_products -\n        this.sell_products[this.indexElementToBack].quantity_back)) {\n      content = 'La cantidad a devolver es mayor a la registrada en la compra'\n    } else if ((this.products[this.indexElementToBack].exist_quantity -\n      Number(this.formDevolucion.get('quantity_back')?.value)) < 0) {\n      content = 'No existe esa cantidad en el almacen, los productos ya han sido vendidos'\n    } else {\n      let repayment: repayment = {\n        type: 'compra',\n        date: new Date(),\n        id_operation: this.sell_products[this.indexElementToBack].id_sell,\n        quantity: Number(this.formDevolucion.get('quantity_back')?.value),\n        price: this.sell_products[this.indexElementToBack].sell_price,\n        total: Number(this.formDevolucion.get('quantity_back')?.value) *\n          this.sell_products[this.indexElementToBack].sell_price,\n        coin: this.sell.coin,\n        exist_quantity: this.products[this.indexElementToBack].exist_quantity - Number(this.formDevolucion.get('quantity_back')?.value),\n        weighted_averages: Number((((this.products[this.indexElementToBack].sell_price *\n          this.products[this.indexElementToBack].exist_quantity) -\n          (this.comunicatorSvc.converterToMainCoin(this.sell_products[this.indexElementToBack].sell_price, this.sell.exchange) *\n            Number(this.formDevolucion.get('quantity_back')?.value))) /\n          (this.products[this.indexElementToBack].exist_quantity -\n            Number(this.formDevolucion.get('quantity_back')?.value))).toFixed(2)),\n        id_user: this.sell.id_user,\n        id_product: this.sell_products[this.indexElementToBack].id_product,\n      }\n      repayment.weighted_averages = (isNaN(repayment.weighted_averages)) ? 0 : repayment.weighted_averages\n      repayment.weighted_averages = this.comunicatorSvc.converterToSecondaryCoin(repayment.weighted_averages, this.sell.exchange)\n      this.devolucionesSvc.setRepayment(repayment).subscribe(res => {\n        if (res.title.includes('Registrada')) {\n          this.repayments.push(repayment)\n          this.sell_products[this.indexElementToBack].quantity_back += Number(this.formDevolucion.get('quantity_back')?.value)\n          this.sell.total_sell -= (Number(this.formDevolucion.get('quantity_back')?.value) *\n            this.sell_products[this.indexElementToBack].sell_price)\n          this.products[this.indexElementToBack].sell_price = this.comunicatorSvc.converterToMainCoin(\n            repayment.weighted_averages, this.sell.exchange)\n\n          this.products[this.indexElementToBack].sell_price =\n            Number((((this.products[this.indexElementToBack].sell_price *\n              this.products[this.indexElementToBack].exist_quantity) -\n              (this.comunicatorSvc.converterToMainCoin(this.sell_products[this.indexElementToBack].sell_price, this.sell.exchange) *\n                Number(this.formDevolucion.get('quantity_back')?.value))) /\n              (this.products[this.indexElementToBack].exist_quantity -\n                Number(this.formDevolucion.get('quantity_back')?.value))).toFixed(2))\n          this.products[this.indexElementToBack].exist_quantity = repayment.exist_quantity\n          console.log(this.products[this.indexElementToBack].sell_price)\n          this.products[this.indexElementToBack].sell_price = (\n            this.products[this.indexElementToBack].exist_quantity === 0) ? 0 : this.products[this.indexElementToBack].sell_price\n          this.ventasSvc.updateSell(this.sell_products[this.indexElementToBack].id_sell, this.sell).subscribe(\n            res => console.log(res)\n          )\n          this.ventasSvc.updateProductsSell(this.sell_products[this.indexElementToBack].id_sell,\n            this.sell_products[this.indexElementToBack].id_product, this.sell_products[this.indexElementToBack]).subscribe(\n              res => console.log(res)\n            )\n          this.productosSvc.updateProducto(this.products[this.indexElementToBack].id_product,\n            this.products[this.indexElementToBack]).subscribe(res => console.log(res))\n        }\n        console.log(res)\n        this.changeModal(res)\n        this.popUp?.nativeElement.showModal()\n      })\n    }\n    if (content !== '') {\n      let values: alert = {\n        icon: 'fa-regular fa-circle-xmark',\n        title: 'Ocurrió un error inesperado',\n        content: content\n      }\n      this.changeModal(values)\n      this.popUp?.nativeElement.showModal()\n    }\n  }\n\n  calcularSubtotal(index: number) {\n    let price = this.products[index].sell_price\n    let discount = this.products[index].discount\n    let quantity = this.sell_products[index].quantity_products\n    return Number(((price * quantity) - (Number((price * discount).toFixed(2)) * quantity)).toFixed(2))\n  }\n\n  calcularTotal() {\n    let total = 0\n    this.products.forEach((product: product, index: number) => {\n      total += this.calcularSubtotal(index)\n    });\n    return total\n  }\n  calcularDescuentoVenta() {\n    return Number((this.sell.discount * this.calcularTotal()).toFixed(2))\n  }\n  calcularImpuestoVenta() {\n    let montoImponible = 0\n    this.products.forEach((product: product, index: number) => {\n      if (product.impuest > 0) {\n        montoImponible += Number((product.impuest * this.calcularSubtotal(index)).toFixed(2))\n      }\n    })\n    return montoImponible\n  }\n  total() {\n    return Number((this.calcularTotal() + this.calcularImpuestoVenta() - this.calcularDescuentoVenta()).toFixed(2))\n  }\n  redirectToVentasRealizadas() {\n    this.location.back()\n  }\n  product(repayment: repayment) {\n    let name_product = ''\n    this.products.forEach((product: product) => {\n      if (product.id_product === repayment.id_product) {\n        name_product = product.name + ' ' + product.mark + ' ' + product.model\n      }\n    })\n    return name_product\n  }\n  acept() {\n    if (this.popUp?.nativeElement.children[1].textContent === 'Ocurrió un error inesperado') {\n      this.cancel(this.popUp)\n    } else {\n      this.cancel(this.popUp)\n      this.cancel(this.quantityBack)\n    }\n  }\n}\n","<div class=\"form-container\">\n    <div class=\"datos\">\n        <p>id sell {{sell.id_sell}}</p>\n        <button (click)=\"redirectToVentasRealizadas()\" class=\"form-button btn-save\"><i class=\"fas fa-reply\"></i>\n            &nbsp;Regresar</button>\n    </div>\n    <div class=\"table-container\">\n        <div class=\"table-title\">\n            <h6>productos vendidos</h6>\n        </div>\n        <div class=\"table-body\">\n            <div class=\"table-responsive\">\n                <table class=\"table table-bordered\">\n                    <thead>\n                        <tr>\n                            <th>N°</th>\n                            <th>Código de barra</th>\n                            <th>Producto</th>\n                            <th>Cantidad</th>\n                            <th>Precio de venta</th>\n                            <th>Descuento</th>\n                            <th>Valor de descuento</th>\n                            <th>IVA</th>\n                            <th>Sub total</th>\n                            <th>Devolución</th>\n                        </tr>\n                    </thead>\n\n                    <tbody #tab>\n                        <tr *ngFor=\"let sell_product of sell_products; let i=index\">\n                            <td>{{i+1}}</td>\n                            <td *ngIf=\"products[i]!=undefined\">{{products[i].barcode}}</td>\n                            <td *ngIf=\"products[i]!=undefined\">\n                                {{products[i].name}}&nbsp;{{products[i].mark}}&nbsp;{{products[i].model}}&nbsp;</td>\n                            <td>{{sell_product.quantity_products}} </td>\n                            <td>{{sell_product.sell_price|currency:sell.coin+' '}}</td>\n                            <td>{{sell_product.discount_product|percent:'2.2-2'}}</td>\n                            <td>{{sell_product.discount_product*sell_product.sell_price|currency:sell.coin+' '}}</td>\n                            <td>{{sell_product.impuest|percent:'2.2-2'}}</td>\n                            <td>{{calcularSubtotal(i)|currency:sell.coin+' '}}</td>\n                            <td class=\"icon\" (click)=\"showModal(products[i],i)\">\n                                <i class=\"fas fa-truck-loading fa-fw\" style=\"color:#009688\"></i>\n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    </div>\n    <div class=\"totales\">\n        <div>\n            <p><strong>SUBTOTAL </strong></p>\n            <p>+ {{calcularTotal()|currency:sell.coin+' '}}</p>\n        </div>\n        <div>\n            <p><strong>IVA </strong></p>\n            <p>+ {{calcularImpuestoVenta()|currency:sell.coin+' '}}</p>\n        </div>\n        <div>\n            <p><strong>DESCUENTO </strong></p>\n            <p>- {{calcularDescuentoVenta()|currency:sell.coin+' '}}</p>\n        </div>\n        <div>\n            <p><strong>TOTAL </strong></p>\n            <p>{{total()|currency:sell.coin+' '}}</p>\n        </div>\n    </div>\n    <div class=\"line\"></div>\n    <div class=\"table-container\">\n        <div class=\"table-title\">\n            <h6>Pagos realizados</h6>\n        </div>\n        <div class=\"table-body\">\n            <div class=\"table-responsive\">\n                <table class=\"table table-bordered\">\n                    <thead>\n                        <tr>\n                            <th>N°</th>\n                            <th>Fecha</th>\n                            <th>Tipo de venta</th>\n                            <th>Monto</th>\n                            <th>Referencia</th>\n                            <th>Vendedor</th>\n                            <th>caja</th>\n                        </tr>\n                    </thead>\n\n                    <tbody #tab>\n                       <tr *ngFor=\"let pay of pays; let i=index\">\n                        <td>{{i+1}}</td>\n                        <td>{{pay.date|date:'dd/MM/yyyy'}}</td>\n                        <td>{{pay.type}}</td> \n                        <td>{{pay.mount|currency:pay.coin+' '}}</td>\n                        <td>{{pay.reference}}</td>\n                        <td>{{user_pay[i].names_user}} {{user_pay[i].last_names_user}}</td>\n                        <td>{{registers_pay[i].name}}</td>\n                    </tr>\n                        \n                    </tbody> \n                </table>\n            </div>\n        </div>\n    </div>\n    <div class=\"table-container\">\n        <div class=\"table-title\">\n            <h6>Devoluciones realizadas</h6>\n        </div>\n        <div class=\"table-body\">\n            <div class=\"table-responsive\">\n                <table class=\"table table-bordered\">\n                    <thead>\n                        <tr>\n                            <th>N°</th>\n                            <th>Fecha</th>\n                            <th>Producto</th>\n                            <th>Cantidad</th>\n                            <th>Precio de compra</th>\n                            <th>Total</th>\n                            <th>Vendedor</th>\n                            <th>caja</th>\n                        </tr>\n                    </thead>\n\n                    <!-- <tbody #tab>\n                       <tr *ngFor=\"let repayment of repayments; let i=index\">\n                        <td>{{i+1}}</td>\n                        <td>{{repayment.date|date:'dd/MM/yyyy'}}</td>\n                        <td>{{product(repayment)}}</td> \n                        <td>{{repayment.quantity}}</td>\n                        <td>{{repayment.price|currency:repayment.coin+' '}}</td>\n                        <td>{{repayment.total|currency:repayment.coin+' '}}</td>\n                    </tr>\n                        \n                    </tbody> -->\n                </table>\n            </div>\n        </div>\n    </div>\n</div>\n<dialog #quantity class=\"quantity\">\n    <div class=\"header\">\n        <h2 class=\"title\">Realizar devolución</h2>\n        <button class=\"btn-cerrar-dialog\" (click)=\"cancel(quantityBack)\">x</button>\n    </div>\n    <div class=\"form\" [formGroup]=\"formDevolucion\">\n        <div class=\"form-control\" [ngClass]=\"{'input-on-focus-success':verifyStyleInput(formDevolucion,'quantity_back')&&\n    elementHasFocus[7],'input-on-focus-fail':!verifyStyleInput(formDevolucion,'quantity_back')}\">\n            <label class=\"form-label\" [ngClass]=\"{'label-on-focus-down':\nelementHasFocus[7]&&positionLabel[7],\n'label-on-focus-up':\nelementHasFocus[7]&&!positionLabel[7]}\" [ngStyle]=\"animationLabel(formDevolucion,\n'quantity_back')\">\n                Cantidad a devolver\n            </label>\n            <input formControlName=\"quantity_back\" (focus)=\"isFocused(7,formDevolucion,'quantity_back')\"\n                (focusout)=\"isFocused(7,formDevolucion,'quantity_back')\" class=\"form-input\"\n                [ngStyle]=\"styleForeground(formDevolucion,'quantity_back')\" (keypress)=\"validate($event,false)\">\n        </div>\n    </div>\n    <div class=\"form-actions\">\n        <button class=\"form-button btn\"\n            [ngClass]=\"{'enable aceptar':formDevolucion.get('quantity_back')?.value.length>0}\"\n            (click)=\"registrarDevolucion()\">\n            <i class=\"fas fa-truck-loading fa-fw\"></i> &nbsp;&nbsp;REALIZAR DEVOLUCIÓN</button>\n        <button class=\"form-button btn enable\" (click)=\"cancel(quantityBack)\" style=\"color:#f44336\">\n            <i class=\"far fa-times-circle\"></i> &nbsp;&nbsp;CANCELAR</button>\n    </div>\n</dialog>\n<dialog class=\"dialog\" #popup>\n    <i class=\"fa-regular fa-circle-question\"></i>\n    <h3>¿Estas seguro?</h3>\n    <p>Lois datos seran guardados en el sistema</p>\n    <div>\n        <button class=\"form-button btn-save\" (click)=\"acept()\">\n            &nbsp;&nbsp;ACEPTAR</button>\n        <button *ngIf=\"this.popUp?.nativeElement.children[1].textContent === '¿Estás seguro?'\"\n            class=\"form-button btn-cancel\" (click)=\"cancel(popUp)\">\n            &nbsp;&nbsp;CANCELAR</button>\n    </div>\n</dialog>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}