{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component, ViewChild } from '@angular/core';\nimport { FormControl, Validators } from '@angular/forms';\nimport { DinamicInput } from 'src/app/utils/DinamicInput';\nlet NuevoProductoComponent = class NuevoProductoComponent extends DinamicInput {\n  constructor(fb, routes, comunicatorSvc, categoriesSvc, productsSvc, renderer) {\n    super();\n    this.fb = fb;\n    this.routes = routes;\n    this.comunicatorSvc = comunicatorSvc;\n    this.categoriesSvc = categoriesSvc;\n    this.productsSvc = productsSvc;\n    this.renderer = renderer;\n    this.categories = [];\n    this.vence = true;\n  }\n  ngOnInit() {\n    let title = [];\n    setTimeout(() => {\n      /* Obtengo la ruta actual y la transformo para obtener el titulo del componente*/\n      this.ruta = this.routes.url.slice(this.routes.url.slice(1).indexOf('/') + 2);\n      title.push(\"fas fa-box fa-fw\"); //aañado el icono del titulo al array\n      title.push(decodeURI(this.ruta).toUpperCase()); //añado el titulo al array\n      this.comunicatorSvc.setTitleComponent(title);\n    });\n    this.categoriesSvc.getCategories().subscribe(res => {\n      this.categories = res;\n    });\n    this.formNewProduct = this.fb.group({\n      barcode: new FormControl('', [Validators.required, Validators.pattern(/^[0-9]+$/)]),\n      name: new FormControl('', [Validators.required, Validators.pattern(/^[a-zA-Z ]+$/)]),\n      mark: new FormControl('', [Validators.pattern(/^[a-zA-Z ]+$/)]),\n      model: new FormControl('', [Validators.pattern(/^[a-zA-Z ]+$/)]),\n      discount: new FormControl('', [Validators.required, Validators.pattern(/^[0-9]+$/)]),\n      garanty: new FormControl('Habilitada', [Validators.required]),\n      expir: new FormControl(),\n      time_unit: new FormControl('', [Validators.pattern(/^[0-9]+$/)]),\n      id_category: new FormControl(0)\n    });\n  }\n  setVencimiento(vence) {\n    this.vence = vence;\n  }\n  acept() {\n    this.popUp?.nativeElement.close();\n    if (this.popUp?.nativeElement.children[1].textContent === '¿Estás seguro?') {\n      if (this.ruta.indexOf(\"actualizar\")) {\n        this.submit();\n      } else if (this.popUp?.nativeElement.children[2].textContent.includes('¿desea continuar?')) {\n        this.redirectToListProducts();\n      } else {\n        this.validarUpdate();\n      }\n    } else if (this.popUp?.nativeElement.children[1].textContent.includes('Actualizado') && this.ruta.includes(\"actualizar\")) {\n      this.redirectToListProducts();\n    }\n  }\n  error(error) {\n    this.changeModal(this.comunicatorSvc.errorServer(error));\n    this.popUp?.nativeElement.showModal();\n  }\n  validarUpdate() {\n    /* if (this.formNewProduct.get('document_type')?.value === this.userToUpdate.document_type &&\n      this.formNewProduct.get('document_number')?.value === this.userToUpdate.document_number &&\n      this.formNewProduct.get('names')?.value === this.userToUpdate.names &&\n      this.formNewProduct.get('last_names')?.value === this.userToUpdate.last_names &&\n      this.formNewProduct.get('range')?.value === this.userToUpdate.range &&\n      this.formNewProduct.get('state')?.value === this.userToUpdate.state &&\n      this.formNewProduct.get('gander')?.value === this.userToUpdate.gander &&\n      this.formNewProduct.get('id_register')?.value === this.userToUpdate.id_register &&\n      this.formNewProduct.get('phone_number')?.value === this.userToUpdate.phone_number &&\n      this.formNewProduct.get('email')?.value === this.userToUpdate.email &&\n      this.formNewProduct.get('password')?.value === this.userToUpdate.password) {\n      let msj: alert = {\n        icon: '',\n        title: '¿Estás seguro?',\n        content: 'No ha modificado los datos del usuario ¿desea continuar?'\n      }\n      this.changeModal(msj)\n      this.popUp?.nativeElement.showModal()\n    } else {\n      this.update()\n    } */\n  }\n  redirectToListProducts() {\n    this.routes.navigate(['/administracion/lista usuarios']);\n  }\n  submit() {\n    console.log(this.formNewProduct.value);\n    this.productsSvc.setProducto(this.formNewProduct.value).subscribe({\n      next: res => {\n        console.log(res);\n        this.changeModal(res);\n        this.popUp?.nativeElement.showModal();\n      },\n      error: error => {\n        this.error(error);\n      }\n    });\n  }\n  clean() {\n    this.formNewProduct.get('barcode')?.setValue('');\n    this.formNewProduct.get('productName')?.setValue('');\n    this.formNewProduct.get('lastNamesUser')?.setValue('');\n    this.formNewProduct.get('mark')?.setValue('');\n    this.formNewProduct.get('model')?.setValue('');\n    this.formNewProduct.get('discount')?.setValue('');\n    this.formNewProduct.get('timeUnit')?.setValue('');\n  }\n};\n__decorate([ViewChild('popup', {\n  static: true\n})], NuevoProductoComponent.prototype, \"popUp\", void 0);\nNuevoProductoComponent = __decorate([Component({\n  selector: 'app-nuevo-producto',\n  templateUrl: './nuevo-producto.component.html',\n  styleUrls: ['./nuevo-producto.component.css']\n})], NuevoProductoComponent);\nexport { NuevoProductoComponent };","map":{"version":3,"mappings":"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","names":["Component","ViewChild","FormControl","Validators","DinamicInput","NuevoProductoComponent","constructor","fb","routes","comunicatorSvc","categoriesSvc","productsSvc","renderer","ngOnInit","title","setTimeout","ruta","url","slice","indexOf","push","decodeURI","toUpperCase","setTitleComponent","getCategories","subscribe","res","categories","formNewProduct","group","barcode","required","pattern","name","mark","model","discount","garanty","expir","time_unit","id_category","setVencimiento","vence","acept","popUp","nativeElement","close","children","textContent","submit","includes","redirectToListProducts","validarUpdate","error","changeModal","errorServer","showModal","navigate","console","log","value","setProducto","next","clean","get","setValue","__decorate","static","selector","templateUrl","styleUrls"],"sourceRoot":"","sources":["/home/luis/Documentos/systems vs code/inventary-system/client/src/app/content/productos/nuevo-producto/nuevo-producto.component.ts"],"sourcesContent":["import { Component, ElementRef, ViewChild } from '@angular/core';\nimport { FormBuilder, FormControl, FormGroup, Validators } from '@angular/forms';\nimport { Router } from '@angular/router';\nimport { category ,alert} from 'src/app/interfaces/interfaces';\nimport { ComunicatorComponetsService } from 'src/app/services/comunicator/comunicator-componets.service';\nimport { DinamicInput } from 'src/app/utils/DinamicInput';\nimport { CategoriasService } from '../../administracion/categorias/service/categorias.service';\nimport { HttpErrorResponse } from '@angular/common/http';\nimport { ProductosService } from '../productos-en-almacen/service/productos.service';\n\n@Component({\n  selector: 'app-nuevo-producto',\n  templateUrl: './nuevo-producto.component.html',\n  styleUrls: ['./nuevo-producto.component.css']\n})\nexport class NuevoProductoComponent extends DinamicInput {\n  formNewProduct!: FormGroup;\n  categories:category[]=[]\n  vence:boolean=true\n  ruta!:string\n  \n  @ViewChild('popup', { static: true }) override popUp?: ElementRef;\n\n  constructor(private fb: FormBuilder,\n    private routes: Router, \n    private comunicatorSvc: ComunicatorComponetsService,\n    private categoriesSvc:CategoriasService,\n    private productsSvc:ProductosService,\n    protected override renderer: Renderer2) {\n    super();\n  }\n  ngOnInit() {\n    let title: string[] = [];\n    setTimeout(() => {\n      /* Obtengo la ruta actual y la transformo para obtener el titulo del componente*/\n      this.ruta = this.routes.url.slice((this.routes.url.slice(1).indexOf('/')) + 2);\n      title.push(\"fas fa-box fa-fw\");//aañado el icono del titulo al array\n      title.push(decodeURI(this.ruta).toUpperCase());//añado el titulo al array\n      this.comunicatorSvc.setTitleComponent(title);\n    });\n    this.categoriesSvc.getCategories().subscribe(\n      res=>{this.categories=res}\n    )\n    this.formNewProduct = this.fb.group(\n      {\n        barcode: new FormControl('', [Validators.required, Validators.pattern(/^[0-9]+$/)]),\n        name: new FormControl('',[Validators.required, Validators.pattern(/^[a-zA-Z ]+$/)]),\n        mark: new FormControl('',[Validators.pattern(/^[a-zA-Z ]+$/)]),\n        model: new FormControl('',[Validators.pattern(/^[a-zA-Z ]+$/)]),\n        discount: new FormControl('', [Validators.required, Validators.pattern(/^[0-9]+$/)]),\n        garanty: new FormControl('Habilitada',[Validators.required]),\n        expir:new FormControl(),\n        time_unit:new FormControl('',[Validators.pattern(/^[0-9]+$/)]),\n        id_category:new FormControl(0)\n      }\n    )\n  }\n  setVencimiento(vence:boolean){\n    this.vence=vence\n  }\n  acept() {\n    this.popUp?.nativeElement.close();\n    if (this.popUp?.nativeElement.children[1].textContent === '¿Estás seguro?') {\n      if (this.ruta.indexOf(\"actualizar\")) {\n        this.submit()\n      } else if (this.popUp?.nativeElement.children[2].textContent.includes('¿desea continuar?')) {\n        this.redirectToListProducts();\n      } else {\n        this.validarUpdate()\n      }\n    } else if (this.popUp?.nativeElement.children[1].textContent.includes('Actualizado') &&\n      this.ruta.includes(\"actualizar\")) {\n      this.redirectToListProducts();\n    }\n  }\n  public error(error: HttpErrorResponse) {\n    this.changeModal(this.comunicatorSvc.errorServer(error))\n    this.popUp?.nativeElement.showModal()\n  }\n  validarUpdate() {\n    /* if (this.formNewProduct.get('document_type')?.value === this.userToUpdate.document_type &&\n      this.formNewProduct.get('document_number')?.value === this.userToUpdate.document_number &&\n      this.formNewProduct.get('names')?.value === this.userToUpdate.names &&\n      this.formNewProduct.get('last_names')?.value === this.userToUpdate.last_names &&\n      this.formNewProduct.get('range')?.value === this.userToUpdate.range &&\n      this.formNewProduct.get('state')?.value === this.userToUpdate.state &&\n      this.formNewProduct.get('gander')?.value === this.userToUpdate.gander &&\n      this.formNewProduct.get('id_register')?.value === this.userToUpdate.id_register &&\n      this.formNewProduct.get('phone_number')?.value === this.userToUpdate.phone_number &&\n      this.formNewProduct.get('email')?.value === this.userToUpdate.email &&\n      this.formNewProduct.get('password')?.value === this.userToUpdate.password) {\n      let msj: alert = {\n        icon: '',\n        title: '¿Estás seguro?',\n        content: 'No ha modificado los datos del usuario ¿desea continuar?'\n      }\n      this.changeModal(msj)\n      this.popUp?.nativeElement.showModal()\n    } else {\n      this.update()\n    } */\n  }\n  \n  redirectToListProducts() {\n    this.routes.navigate(['/administracion/lista usuarios'])\n  }\n\n  submit() {\n    console.log(this.formNewProduct.value)\n    this.productsSvc.setProducto(this.formNewProduct.value).subscribe({\n      next: res => {\n        console.log(res)\n        this.changeModal(res);\n        this.popUp?.nativeElement.showModal()\n      },\n      error: (error: HttpErrorResponse) => {\n        this.error(error)\n      }\n    })\n  }\n  clean() {\n    this.formNewProduct.get('barcode')?.setValue('');\n    this.formNewProduct.get('productName')?.setValue('');\n    this.formNewProduct.get('lastNamesUser')?.setValue('');\n    this.formNewProduct.get('mark')?.setValue('');\n    this.formNewProduct.get('model')?.setValue('');\n    this.formNewProduct.get('discount')?.setValue('');\n    this.formNewProduct.get('timeUnit')?.setValue('');\n  }\n\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}